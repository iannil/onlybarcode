<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>二维码识别测试</title>
    <script src="https://unpkg.com/@zxing/library@latest/umd/index.min.js"></script>
</head>
<body>
    <h1>二维码识别测试</h1>
    <input type="file" id="fileInput" accept="image/*" multiple>
    <div id="results"></div>

    <script>
        const { BrowserMultiFormatReader } = ZXing;
        const reader = new BrowserMultiFormatReader();
        
        document.getElementById('fileInput').addEventListener('change', async (e) => {
            const files = Array.from(e.target.files);
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';
            
            for (const file of files) {
                try {
                    const imageUrl = URL.createObjectURL(file);
                    const result = await reader.decodeFromImageUrl(imageUrl);
                    
                    const resultDiv = document.createElement('div');
                    resultDiv.innerHTML = `
                        <h3>${file.name}</h3>
                        <p>内容: ${result.getText()}</p>
                        <p>格式: ${result.getBarcodeFormat()}</p>
                        <img src="${imageUrl}" style="max-width: 200px;">
                    `;
                    resultsDiv.appendChild(resultDiv);
                } catch (error) {
                    const errorDiv = document.createElement('div');
                    errorDiv.innerHTML = `
                        <h3>${file.name}</h3>
                        <p style="color: red;">错误: ${error.message}</p>
                    `;
                    resultsDiv.appendChild(errorDiv);
                }
            }
        });
    </script>
</body>
</html> 